{"job":{"components":{"347398":{"id":347398,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-1008,"y":64,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[350251],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"347422":{"id":347422,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1897708330,"x":-608,"y":64,"width":32,"height":32,"inputConnectorIDs":[350263],"outputSuccessConnectorIDs":[350912],"outputFailureConnectorIDs":[351808],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s3_file_load"}}}},"visible":true},"2":{"slot":2,"name":"Basic/Advanced Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Basic"}}}},"visible":true},"6":{"slot":6,"name":"Data Source","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Hierarchy"}}}},"visible":true},"7":{"slot":7,"name":"Data Selection","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Parent Category"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"Parent Category Tags"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"Category"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"Category Tags"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"Sub Category"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"Sub Category Tags"}}}},"visible":true},"8":{"slot":8,"name":"Data Source Filter","elements":{},"visible":true},"9":{"slot":9,"name":"Combine Filters","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true},"10":{"slot":10,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT ..."}}}},"visible":false},"11":{"slot":11,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true},"12":{"slot":12,"name":"Connection Options","elements":{},"visible":true},"13":{"slot":13,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${DB}"}}}},"visible":true},"14":{"slot":14,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${STAGE_SCHEMA}"}}}},"visible":true},"15":{"slot":15,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ST_BFSI_HIREARCHY"}}}},"visible":true},"16":{"slot":16,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${DW_PRODUCTS}"}}}},"visible":true},"17":{"slot":17,"name":"S3 Staging Area","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"iquanti-matillion"}}}},"visible":true},"18":{"slot":18,"name":"Primary Keys","elements":{},"visible":true},"20":{"slot":20,"name":"Data Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"400":{"slot":400,"name":"Storage URL","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s3://iquanti-matillion/ALPS/BFSI/DEV/HIERARCHY/${HIERARCHY}"}}}},"visible":true},"401":{"slot":401,"name":"Cell Range","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"402":{"slot":402,"name":"Contains Header Row","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"498":{"slot":498,"name":"Storage Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Amazon S3 Storage"}}}},"visible":true},"1001":{"slot":1001,"name":"","elements":{},"visible":false},"1013":{"slot":1013,"name":"Auto Debug","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Off"}}}},"visible":true},"1014":{"slot":1014,"name":"Debug Level","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"3"}}}},"visible":false},"40000":{"slot":40000,"name":"Encryption","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":true},"40001":{"slot":40001,"name":"KMS Key ID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"40501":{"slot":40501,"name":"","elements":{},"visible":false},"40502":{"slot":40502,"name":"Load Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":""}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}}},"visible":true},"63320":{"slot":63320,"name":"Storage Account","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"63321":{"slot":63321,"name":"Blob Container","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"88340":{"slot":88340,"name":"","elements":{},"visible":false},"88341":{"slot":88341,"name":"Staging","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Existing Amazon S3 Location"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"350246":{"id":350246,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-752,"y":64,"width":32,"height":32,"inputConnectorIDs":[350251],"outputSuccessConnectorIDs":[350263],"outputFailureConnectorIDs":[351773],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AUDIT_TABLE__UPDATE_ENTRY"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into \"${DB}\".\"${STAGE_SCHEMA}\".st_audit \n(status,start_time,job_name,s3_path,file_name)\nvalues('In progress',current_timestamp,'HIERARCHY LOAD','${S3_PATH}HIERARCHY','${HIERARCHY}')"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"350913":{"id":350913,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":-480,"y":64,"width":32,"height":32,"inputConnectorIDs":[350912],"outputSuccessConnectorIDs":[352772],"outputFailureConnectorIDs":[351829],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PARENT_CATEGORY_LOAD"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TR_STG2LKP_PARENT_HIERARCHY_LOAD_DAILY"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"350983":{"id":350983,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-16,"y":64,"width":32,"height":32,"inputConnectorIDs":[351894],"outputSuccessConnectorIDs":[351948],"outputFailureConnectorIDs":[351838],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AUDIT_TABLE_SUCCESS_STATUS"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"update \"${DB}\".\"${STAGE_SCHEMA}\".audit\nset status = 'Completed'\n,end_time = current_timestamp \n,file_count=(select cnt from (\nSELECT COUNT(\"created_date\")cnt from \"${DB}\".\"${DWH_SCHEMA}\".\"LKP_BFSI_HIERARCHY\" where \"file_name\"='${HIERARCHY}'\n))\n,duplicate_count=(select case when sum(cnt) is null then 0 else sum(cnt) end as cnt from (\nselect  CATEGORY_TAG ,count(CATEGORY_TAG)cnt FROM \"${DB}\".\"${DWH_SCHEMA}\".\"LKP_BFSI_CATEGORY_HIERARCHY\"\n group by CATEGORY_TAG,PARENT_CATEGORY_DESC,CATEGORY,SUBCATEGORY,SUBCATEGORY_TAG,\n  UNIVERSE,LOCALE\n  HAVING COUNT(CATEGORY_TAG) >1))\nwhere audit_id = (select max(audit_id) from \"${DB}\".\"${STAGE_SCHEMA}\".audit where job_name='HIERARCHY LOAD')"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"351760":{"id":351760,"inputCardinality":"MANY","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1343684451,"x":-400,"y":-64,"width":32,"height":32,"inputConnectorIDs":[351773,351808,351829,351838,353877,353878],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[351916],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Error_Handling"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"351846":{"id":351846,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-30576616,"x":-192,"y":64,"width":32,"height":32,"inputConnectorIDs":[352768],"outputSuccessConnectorIDs":[351894],"outputFailureConnectorIDs":[353878],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TAGGING_ARCHIVE_MOVE"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"aws s3 mv '${S3_PATH}'HIERARCHY/'${HIERARCHY}' '${S3_PATH}'HIERARCHY/ARCHIVE/`date \"+%Y%m%d\"`/'${HIERARCHY}'\n\n\n\n\n"}}}},"visible":true},"3":{"slot":3,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"351870":{"id":351870,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-64,"y":-64,"width":32,"height":32,"inputConnectorIDs":[351916],"outputSuccessConnectorIDs":[351946],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AUDIT_TABLE_FAILED_STATUS"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"update \"${DB}\".\"${STAGE_SCHEMA}\".audit\nset status = 'Failed'\n,end_time = current_timestamp \n,file_count=(select cnt from (\nSELECT COUNT(\"created_date\")cnt from \"${DB}\".\"${DWH_SCHEMA}\".LKP_BFSI_HIERARCHY where \"file_name\"='${HIERARCHY}'\n))\n,duplicate_count=(select case when sum(cnt) is null then 0 else sum(cnt) end as cnt from (\nselect  CATEGORY_TAG ,count(CATEGORY_TAG)cnt FROM \"${DB}\".\"${DWH_SCHEMA}\".\"LKP_BFSI_CATEGORY_HIERARCHY\"\n group by CATEGORY_TAG,PARENT_CATEGORY_DESC,CATEGORY,SUBCATEGORY,SUBCATEGORY_TAG,\n  UNIVERSE,LOCALE\n  HAVING COUNT(CATEGORY_TAG) >1))\nwhere audit_id = (select max(audit_id) from \"${DB}\".\"${STAGE_SCHEMA}\".audit where job_name='HIERARCHY LOAD')"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"351939":{"id":351939,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":128,"y":64,"width":32,"height":32,"inputConnectorIDs":[351948],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Success"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"351945":{"id":351945,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":112,"y":-64,"width":32,"height":32,"inputConnectorIDs":[351946],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"352773":{"id":352773,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":-336,"y":64,"width":32,"height":32,"inputConnectorIDs":[352772],"outputSuccessConnectorIDs":[352768],"outputFailureConnectorIDs":[353877],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TR_CATEGORY_LOAD"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TR_STG2LKP_HIERARCHY_CATEGORY_LOAD_DAILY"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"350263":{"id":350263,"sourceID":350246,"targetID":347422},"350912":{"id":350912,"sourceID":347422,"targetID":350913},"351894":{"id":351894,"sourceID":351846,"targetID":350983},"351946":{"id":351946,"sourceID":351870,"targetID":351945},"351948":{"id":351948,"sourceID":350983,"targetID":351939},"352768":{"id":352768,"sourceID":352773,"targetID":351846},"352772":{"id":352772,"sourceID":350913,"targetID":352773}},"failureConnectors":{"351773":{"id":351773,"sourceID":350246,"targetID":351760},"351808":{"id":351808,"sourceID":347422,"targetID":351760},"351829":{"id":351829,"sourceID":350913,"targetID":351760},"351838":{"id":351838,"sourceID":350983,"targetID":351760},"353877":{"id":353877,"sourceID":352773,"targetID":351760},"353878":{"id":353878,"sourceID":351846,"targetID":351760}},"unconditionalConnectors":{"350251":{"id":350251,"sourceID":347398,"targetID":350246},"351916":{"id":351916,"sourceID":351760,"targetID":351870}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"canUndo":true,"undoCommand":"Move Components","undoCreated":1597130474627,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{},"variables":{},"grids":{}},"info":{"name":"O_S32STG_BFS_TAGS_CLASSIFICATION_LOAD_DAILY","description":"","type":"ORCHESTRATION"}}