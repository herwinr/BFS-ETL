{"job":{"components":{"381638":{"id":381638,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":320,"y":64,"width":32,"height":32,"inputConnectorIDs":[391076],"outputConnectorIDs":[391091],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Calculator"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CASE\n\tWHEN \"LOCALE\" = 'CC_UK' THEN 'en-gb'\n    ELSE 'en-us'\nEND"},"2":{"slot":2,"type":"STRING","value":"LOCALE"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"390565":{"id":390565,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":80,"y":64,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[391076],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SQL 0"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT\n    PARENT_CATEGORY_DESC,\n    CATEGORY_NEW AS CATEGORY,\n    CATEGORY_TAG_NEW AS CATEGORY_TAG,\n    SUBCATEGORY_NEW AS SUBCATEGORY,\n    SUBCATEGORY_TAG_NEW AS SUBCATEGORY_TAG,\n    UNIVERSE,\n    LOCALE\nFROM\n(\n  SELECT \n    PARENT_CATEGORY_DESC,\n    CATEGORY,\n    CATEGORY AS CATEGORY_NEW,\n    CATEGORY_TAG AS  CATEGORY_TAG_NEW,\n    SUBCATEGORY AS  SUBCATEGORY_NEW,\n    SUBCATEGORY_TAG AS  SUBCATEGORY_TAG_NEW,\n    UNIVERSE,\n    LOCALE\n  FROM \"BFSI_CI\".\"UAT\".\"STAGE_BFSI_HIERARCHY\" \n  WHERE PARENT_CATEGORY_DESC IN ('Credit Card','Credit Score')\n  AND SUBCATEGORY <> 'Other' \n  AND SUBCATEGORY_TAG <> 'Other'\n  \n  UNION ALL\n  \n   SELECT DISTINCT \n    PARENT_CATEGORY_DESC,\n    CATEGORY,\n    CATEGORY AS CATEGORY_NEW,\n    CATEGORY_TAG AS  CATEGORY_TAG_NEW,\n    'Other' AS  SUBCATEGORY_NEW,\n    'Other' AS  SUBCATEGORY_TAG_NEW,\n    UNIVERSE,\n    LOCALE\n  FROM \"BFSI_CI\".\"UAT\".\"STAGE_BFSI_HIERARCHY\"\n  WHERE PARENT_CATEGORY_DESC IN ('Credit Card','Credit Score')\n  AND CATEGORY <> 'Other'\n  \n  UNION ALL\n  \n    SELECT \n    PARENT_CATEGORY_DESC,\n    CATEGORY,\n    CATEGORY AS CATEGORY_NEW,\n    CATEGORY_TAG AS  CATEGORY_TAG_NEW,\n    SUBCATEGORY AS  SUBCATEGORY_NEW,\n    SUBCATEGORY_TAG AS  SUBCATEGORY_TAG_NEW,\n    UNIVERSE,\n    LOCALE\n  FROM \"BFSI_CI\".\"UAT\".\"STAGE_BFSI_HIERARCHY\" \n  WHERE PARENT_CATEGORY_DESC NOT IN ('Credit Card','Credit Score')\n  \n  UNION ALL\n  \n  SELECT DISTINCT \n    PARENT_CATEGORY_DESC,\n    'Others' AS CATEGORY,\n    'Other' AS CATEGORY_NEW,\n    'Other' AS  CATEGORY_TAG_NEW,\n    'Other' AS  SUBCATEGORY_NEW,\n    'Other' AS  SUBCATEGORY_TAG_NEW,\n    UNIVERSE,\n    LOCALE\n  FROM \"BFSI_CI\".\"UAT\".\"STAGE_BFSI_HIERARCHY\"\n  WHERE PARENT_CATEGORY_DESC IN ('Credit Card','Credit Score')\n  --AND CATEGORY <> 'Other'\n)\nWHERE CATEGORY IS NOT NULL"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"391089":{"id":391089,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":211954775,"x":560,"y":64,"width":32,"height":32,"inputConnectorIDs":[391091],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LKP_BFSI_CATEGORY_HIERARCHY"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LKP_BFSI_CATEGORY_HIERARCHY"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PARENT_CATEGORY_DESC"},"2":{"slot":2,"type":"STRING","value":"PARENT_CATEGORY_DESC"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CATEGORY"},"2":{"slot":2,"type":"STRING","value":"CATEGORY"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"CATEGORY_TAG"},"2":{"slot":2,"type":"STRING","value":"CATEGORY_TAG"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"SUBCATEGORY"},"2":{"slot":2,"type":"STRING","value":"SUBCATEGORY"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"SUBCATEGORY_TAG"},"2":{"slot":2,"type":"STRING","value":"SUBCATEGORY_TAG"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"UNIVERSE"},"2":{"slot":2,"type":"STRING","value":"UNIVERSE"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"LOCALE"},"2":{"slot":2,"type":"STRING","value":"LOCALE"}}}},"visible":true},"5":{"slot":5,"name":"Truncate","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Truncate"}}}},"visible":true},"200":{"slot":200,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"UAT"}}}},"visible":true},"201":{"slot":201,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BFSI_CI"}}}},"visible":true},"202":{"slot":202,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BFSI_CI"}}}},"visible":true},"203":{"slot":203,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"391076":{"id":391076,"sourceID":390565,"targetID":381638},"391091":{"id":391091,"sourceID":381638,"targetID":391089}},"canUndo":true,"undoCommand":"Set Parameter","undoCreated":1597658656857,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"HIERARCHY_CATEGORY_TABLE_LOAD","description":null,"type":"TRANSFORMATION"}}