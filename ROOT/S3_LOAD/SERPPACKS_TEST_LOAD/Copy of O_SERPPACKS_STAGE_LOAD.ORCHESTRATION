{"job":{"components":{"356112":{"id":356112,"inputCardinality":"MANY","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1343684451,"x":-64,"y":-112,"width":32,"height":32,"inputConnectorIDs":[356130,356131,356140,356141,356142,356143],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[356128],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ERROR HANDLING"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"356113":{"id":356113,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-30576616,"x":80,"y":0,"width":32,"height":32,"inputConnectorIDs":[356133],"outputSuccessConnectorIDs":[356123],"outputFailureConnectorIDs":[356131],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ARCHIVE_MOVE"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"aws s3 mv '${S3_PATH}'SERPPACKS/'${SERPPACK}' '${S3_PATH}'SERPPACKS/ARCHIVE/`date \"+%Y%m%d\"`/'${SERPPACK}'\n\n\n\n\n"}}}},"visible":true},"3":{"slot":3,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"356114":{"id":356114,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":432,"y":-112,"width":32,"height":32,"inputConnectorIDs":[356122],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"356115":{"id":356115,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":432,"y":0,"width":32,"height":32,"inputConnectorIDs":[356120],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Success"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"356118":{"id":356118,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-256,"y":0,"width":32,"height":32,"inputConnectorIDs":[356135],"outputSuccessConnectorIDs":[356132],"outputFailureConnectorIDs":[356140],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"S3_TO_STAGE_LOAD"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":" COPY INTO \"${DB}\".\"${STAGE_SCHEMA}\".\"STG_BFSI_SERPPACK\"(\"as_on_date\",\"keyword\",\"locale\",\"device_type\",\"blended_rank\",\"pack_type\")\nFROM\n(\nSELECT $1,$2,$3,$4,$5,$6\nFROM '@DM_INTERNAL.RESEARCH.MATILLION_STAGE_/ALPS/BFSI/DEV/SERPPACKS/${SERPPACK}'\n)\nFILE_FORMAT = DM_INTERNAL.RESEARCH.CSV PURGE=FALSE ON_ERROR = CONTINUE FORCE=FALSE;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"356119":{"id":356119,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-576,"y":0,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[356129],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"356121":{"id":356121,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":-64,"y":0,"width":32,"height":32,"inputConnectorIDs":[356132],"outputSuccessConnectorIDs":[356133],"outputFailureConnectorIDs":[356141],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TR_SERPACKS_DWH_LOAD"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Copy of TR_SERPPACKS_STAGE_TO_DWH_LOAD"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"356124":{"id":356124,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-384,"y":0,"width":32,"height":32,"inputConnectorIDs":[356134],"outputSuccessConnectorIDs":[356135],"outputFailureConnectorIDs":[356143],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AUDIT_TABLE_ENTRY"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into \"${DB}\".\"${STAGE_SCHEMA}\".audit\n(status,start_time,job_name,s3_path,file_name)\nvalues('In progress',current_timestamp,'SERPPACKS LOAD','${S3_PATH}SERPPACKS','${SERPPACK}')"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"356125":{"id":356125,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":237373210,"x":-496,"y":0,"width":32,"height":32,"inputConnectorIDs":[356129],"outputSuccessConnectorIDs":[356134],"outputFailureConnectorIDs":[356142],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TRN_STAGE_TBL"}}}},"visible":true},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${DB}"}}}},"visible":true},"4":{"slot":4,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${STAGE_SCHEMA}"}}}},"visible":true},"5":{"slot":5,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STG_BFSI_SERPPACK"}}}},"visible":true},"6":{"slot":6,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${DW_PRODUCTS}"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"356126":{"id":356126,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":256,"y":0,"width":32,"height":32,"inputConnectorIDs":[356123],"outputSuccessConnectorIDs":[356120],"outputFailureConnectorIDs":[356130],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AUDIT_TABLE_SUCCESS_STATUS"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"update \"${DB}\".\"${STAGE_SCHEMA}\".audit\nset status = 'Completed'\n,end_time = current_timestamp \n,file_count=(select cnt from (\nSELECT COUNT(\"created_date\")cnt from \"${DB}\".\"${DWH_SCHEMA}\".\"LKP_BFSI_SERPPACK_DAILY\" where \"file_name\"='${SERPPACK}'\n))\nwhere audit_id = (select max(audit_id) from \"${DB}\".\"${STAGE_SCHEMA}\".audit where job_name='SERPPACKS LOAD')"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"356127":{"id":356127,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":240,"y":-112,"width":32,"height":32,"inputConnectorIDs":[356128],"outputSuccessConnectorIDs":[356122],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AUDIT_TABLE_FAIL_STATUS"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"update \"${DB}\".\"${STAGE_SCHEMA}\".audit\nset status = 'Failed'\n,end_time = current_timestamp \n,file_count=(select cnt from (\nSELECT COUNT(\"created_date\")cnt from \"${DB}\".\"${DWH_SCHEMA}\".\"LKP_BFSI_SERPPACK_DAILY\" where \"file_name\"='${SERPPACK}'\n))\nwhere audit_id = (select max(audit_id) from \"${DB}\".\"${STAGE_SCHEMA}\".audit where job_name='SERPPACKS LOAD')"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"356120":{"id":356120,"sourceID":356126,"targetID":356115},"356122":{"id":356122,"sourceID":356127,"targetID":356114},"356123":{"id":356123,"sourceID":356113,"targetID":356126},"356132":{"id":356132,"sourceID":356118,"targetID":356121},"356133":{"id":356133,"sourceID":356121,"targetID":356113},"356134":{"id":356134,"sourceID":356125,"targetID":356124},"356135":{"id":356135,"sourceID":356124,"targetID":356118}},"failureConnectors":{"356130":{"id":356130,"sourceID":356126,"targetID":356112},"356131":{"id":356131,"sourceID":356113,"targetID":356112},"356140":{"id":356140,"sourceID":356118,"targetID":356112},"356141":{"id":356141,"sourceID":356121,"targetID":356112},"356142":{"id":356142,"sourceID":356125,"targetID":356112},"356143":{"id":356143,"sourceID":356124,"targetID":356112}},"unconditionalConnectors":{"356128":{"id":356128,"sourceID":356112,"targetID":356127},"356129":{"id":356129,"sourceID":356119,"targetID":356125}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"canUndo":true,"undoCommand":"Set Parameter","undoCreated":1596695996827,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{},"variables":{},"grids":{}},"info":{"name":"Copy of O_SERPPACKS_STAGE_LOAD","description":null,"type":"ORCHESTRATION"}}