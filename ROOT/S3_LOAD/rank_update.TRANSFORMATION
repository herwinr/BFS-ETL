{"job":{"components":{"510889":{"id":510889,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":208,"y":-32,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[510969],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SQL 0"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT * FROM (\nselect\n        MONTH_YR,\n        YYYYMMDD,\n        DEVICETYPE,\n        DOMAIN, LOCALE,\n        topic_id,\n        first_value(keyword) over (partition by topic_id,YYYYMMDD,DEVICETYPE\n    order by\n       search_volume  , keyword) Hero_KW,\n       keyword,\n       search_volume,\n      KW_LOCALE_PRODUCT_KEY\n      from \n(\n   select\n             MONTH_YR,\n             YYYYMMDD,\n             DEVICETYPE,\n             DOMAIN, LOCALE,\n             listagg(theme, '-') within group (order by theme) topic_id,\n             keyword,\n             search_volume ,\n             KW_LOCALE_PRODUCT_KEY\n          from\n             (\n                SELECT \n                   th.keyword,\n                   th.theme,\n                   MONTH_YR,\n                   YYYYMMDD,\n                   DEVICETYPE,\n                   DOMAIN, \n                   agg.LOCALE,\n                   MAX(SEARCH_VOLUME) search_volume,\n                   th.KW_LOCALE_PRODUCT_KEY\n                FROM \"BFSI_CI\".\"UAT\".\"AGG_BFSI_SOS_MONTHLY_TRAFFIC\" as agg\n                INNER JOIN (SELECT DISTINCT KEYWORD,theme,SUBCATEGORY,PARENT_CATEGORY, UNIVERSE,locale,KW_LOCALE_PRODUCT_KEY \n                            FROM \"BFSI_CI\".\"UAT\".\"DIM_BFSI_THEME_KW_LEVEL\") AS th\n                                ON agg.keyword=th.keyword AND agg.locale=th.locale  \n               \n               WHERE  th.SUBCATEGORY='JP Morgan Chase'  \n  \n   AND agg.MONTH_YR='Jul 2020'\n   AND agg.LOCALE='en-us'\n   AND agg.DEVICETYPE='Desktop'\n               and agg.search_volume=6120000\n   AND th.parent_category='Brands' \n                group by\n                   th.keyword,\n                   th.theme,\n                   MONTH_YR,\n                   YYYYMMDD,\n                   DEVICETYPE,\n                   DOMAIN, agg.LOCALE,\n                   th.KW_LOCALE_PRODUCT_KEY\n   \n  )\n   group by\n             MONTH_YR,\n             YYYYMMDD,\n             DEVICETYPE,\n             DOMAIN, LOCALE,\n             keyword,\n             search_volume,\n             KW_LOCALE_PRODUCT_KEY\n             \n             \n  )\n  order by\n      MONTH_YR,\n      YYYYMMDD,\n      DEVICETYPE,\n      DOMAIN, LOCALE,\n      topic_id,\n      hero_kw,\n      keyword,\n      search_volume desc\n      ,KW_LOCALE_PRODUCT_KEY desc\n      )agg\n      order by search_volume desc"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"510903":{"id":510903,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":208,"y":48,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[511006],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DIM_BFSI_THEME_KW_LEVEL"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DIM_BFSI_THEME_KW_LEVEL"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"KEYWORD"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"KW_LOCALE_PRODUCT_KEY"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"PARENT_CATEGORY"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"CATEGORY"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"SUBCATEGORY"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"UAT"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BFSI_CI"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"510956":{"id":510956,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":364,"y":156,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[511015],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DIM_BFSI_SERP_PACK_DATA"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DIM_BFSI_SERP_PACK_DATA"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LOCALE"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"KEYWORD"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"DEVICE"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"PACK_TYPE"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"UAT"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BFSI_CI"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"510971":{"id":510971,"inputCardinality":"MANY","outputCardinality":"MANY","implementationID":-629958239,"x":385,"y":29,"width":32,"height":32,"inputConnectorIDs":[510969,511003,511006,511015],"outputConnectorIDs":[511162],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Join 0"}}}},"visible":true},"2":{"slot":2,"name":"Main Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SQL 0"}}}},"visible":true},"3":{"slot":3,"name":"Main Table Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"agg"}}}},"visible":true},"4":{"slot":4,"name":"Joins","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DIM_BFSI_THEME_KW_LEVEL"},"2":{"slot":2,"type":"STRING","value":"theme"},"3":{"slot":3,"type":"STRING","value":"Inner"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"DIM_BFSI_KE_DOMAIN_SUB_MAP"},"2":{"slot":2,"type":"STRING","value":"domain"},"3":{"slot":3,"type":"STRING","value":"Left"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"DIM_BFSI_SERP_PACK_DATA"},"2":{"slot":2,"type":"STRING","value":"device"},"3":{"slot":3,"type":"STRING","value":"Left"}}}},"visible":true},"5":{"slot":5,"name":"Join Expressions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\"agg\".\"KW_LOCALE_PRODUCT_KEY\"=\"theme\".\"KW_LOCALE_PRODUCT_KEY\"\n\n"},"2":{"slot":2,"type":"STRING","value":"agg_Inner_theme"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"\"agg\".\"KEYWORD\"=\"domain\".\"KEYWORD\"\nand\n\"agg\".\"DOMAIN\"=\"domain\".\"DOMAIN\"\nand\n\"agg\".\"LOCALE\"=\"domain\".\"LOCALE\""},"2":{"slot":2,"type":"STRING","value":"agg_Left_domain"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"\"agg\".\"KEYWORD\"=\"device\".\"KEYWORD\"\nand\n\"agg\".\"DEVICETYPE\"=\"device\".\"DEVICE\"\nand\n\"agg\".\"LOCALE\"=\"device\".\"LOCALE\""},"2":{"slot":2,"type":"STRING","value":"agg_Left_device"}}}},"visible":true},"6":{"slot":6,"name":"Output Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"agg.MONTH_YR"},"2":{"slot":2,"type":"STRING","value":"MONTH_YR"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"agg.YYYYMMDD"},"2":{"slot":2,"type":"STRING","value":"YYYYMMDD"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"agg.DEVICETYPE"},"2":{"slot":2,"type":"STRING","value":"DEVICETYPE"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"agg.DOMAIN"},"2":{"slot":2,"type":"STRING","value":"agg_DOMAIN"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"agg.LOCALE"},"2":{"slot":2,"type":"STRING","value":"agg_LOCALE"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"agg.TOPIC_ID"},"2":{"slot":2,"type":"STRING","value":"TOPIC_ID"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"agg.HERO_KW"},"2":{"slot":2,"type":"STRING","value":"HERO_KW"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"agg.KEYWORD"},"2":{"slot":2,"type":"STRING","value":"agg_KEYWORD"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"agg.SEARCH_VOLUME"},"2":{"slot":2,"type":"STRING","value":"SEARCH_VOLUME"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"agg.KW_LOCALE_PRODUCT_KEY"},"2":{"slot":2,"type":"STRING","value":"agg_KW_LOCALE_PRODUCT_KEY"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"theme.KEYWORD"},"2":{"slot":2,"type":"STRING","value":"theme_KEYWORD"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"theme.KW_LOCALE_PRODUCT_KEY"},"2":{"slot":2,"type":"STRING","value":"theme_KW_LOCALE_PRODUCT_KEY"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"theme.PARENT_CATEGORY"},"2":{"slot":2,"type":"STRING","value":"PARENT_CATEGORY"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"theme.CATEGORY"},"2":{"slot":2,"type":"STRING","value":"CATEGORY"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"theme.SUBCATEGORY"},"2":{"slot":2,"type":"STRING","value":"SUBCATEGORY"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"domain.SUB_DOMAIN"},"2":{"slot":2,"type":"STRING","value":"SUB_DOMAIN"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"domain.DOMAIN"},"2":{"slot":2,"type":"STRING","value":"domain_DOMAIN"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"domain.KEYWORD"},"2":{"slot":2,"type":"STRING","value":"domain_KEYWORD"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"domain.LOCALE"},"2":{"slot":2,"type":"STRING","value":"domain_LOCALE"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"device.LOCALE"},"2":{"slot":2,"type":"STRING","value":"device_LOCALE"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"device.KEYWORD"},"2":{"slot":2,"type":"STRING","value":"device_KEYWORD"}}},"22":{"slot":22,"values":{"1":{"slot":1,"type":"STRING","value":"device.DEVICE"},"2":{"slot":2,"type":"STRING","value":"DEVICE"}}},"23":{"slot":23,"values":{"1":{"slot":1,"type":"STRING","value":"device.PACK_TYPE"},"2":{"slot":2,"type":"STRING","value":"PACK_TYPE"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"510977":{"id":510977,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":192,"y":128,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[511003],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DIM_BFSI_KE_DOMAIN_SUB_MAP"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DIM_BFSI_KE_DOMAIN_SUB_MAP"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SUB_DOMAIN"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"DOMAIN"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"KEYWORD"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"LOCALE"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"UAT"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BFSI_CI"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"511112":{"id":511112,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":211954775,"x":576,"y":0,"width":32,"height":32,"inputConnectorIDs":[511161],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AGG_BFSI_CONTENT_OVERVIEW_BKP"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AGG_BFSI_CONTENT_OVERVIEW_BKP"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"MONTH_YR"},"2":{"slot":2,"type":"STRING","value":"MONTH_YR"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"YYYYMMDD"},"2":{"slot":2,"type":"STRING","value":"YYYYMMDD"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"HERO_KW"},"2":{"slot":2,"type":"STRING","value":"CONTENT_KEYWORD"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"agg_KEYWORD"},"2":{"slot":2,"type":"STRING","value":"KEYWORD"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"agg_LOCALE"},"2":{"slot":2,"type":"STRING","value":"LOCALE"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"SEARCH_VOLUME"},"2":{"slot":2,"type":"STRING","value":"SEARCH_VOLUME"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"DEVICETYPE"},"2":{"slot":2,"type":"STRING","value":"DEVICETYPE"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"domain_DOMAIN"},"2":{"slot":2,"type":"STRING","value":"DOMAIN"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"SUB_DOMAIN"},"2":{"slot":2,"type":"STRING","value":"SUB_DOMAIN"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"PACK_TYPE"},"2":{"slot":2,"type":"STRING","value":"PACK_TYPE"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"PARENT_CATEGORY"},"2":{"slot":2,"type":"STRING","value":"PARENT_CATEGORY"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"CATEGORY"},"2":{"slot":2,"type":"STRING","value":"CATEGORY"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"SUBCATEGORY"},"2":{"slot":2,"type":"STRING","value":"SUBCATEGORY"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"url"},"2":{"slot":2,"type":"STRING","value":"URL"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"rank"},"2":{"slot":2,"type":"STRING","value":"RANK"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"TOPIC_DIFFICULTY"},"2":{"slot":2,"type":"STRING","value":"TOPIC_DIFFICULTY"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"SV_TREND"},"2":{"slot":2,"type":"STRING","value":"SV_TREND"}}}},"visible":true},"5":{"slot":5,"name":"Truncate","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Append"}}}},"visible":true},"200":{"slot":200,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"UAT"}}}},"visible":true},"201":{"slot":201,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BFSI_CI"}}}},"visible":true},"202":{"slot":202,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BFSI_CI"}}}},"visible":true},"203":{"slot":203,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"511163":{"id":511163,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":478,"y":12,"width":32,"height":32,"inputConnectorIDs":[511162],"outputConnectorIDs":[511161],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Calculator 0"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"null"},"2":{"slot":2,"type":"STRING","value":"url"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"0"},"2":{"slot":2,"type":"STRING","value":"rank"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"0"},"2":{"slot":2,"type":"STRING","value":"TOPIC_DIFFICULTY"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"0"},"2":{"slot":2,"type":"STRING","value":"SV_TREND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"510969":{"id":510969,"sourceID":510889,"targetID":510971},"511003":{"id":511003,"sourceID":510977,"targetID":510971},"511006":{"id":511006,"sourceID":510903,"targetID":510971},"511015":{"id":511015,"sourceID":510956,"targetID":510971},"511161":{"id":511161,"sourceID":511163,"targetID":511112},"511162":{"id":511162,"sourceID":510971,"targetID":511163}},"canUndo":true,"undoCommand":"Set Parameter","undoCreated":1600263375115,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"rank_update","description":null,"type":"TRANSFORMATION"}}