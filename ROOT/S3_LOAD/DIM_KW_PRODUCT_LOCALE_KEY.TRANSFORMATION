{"job":{"components":{"425392":{"id":425392,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":291,"y":108,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[425405],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PRODUCT_LOCALE_KEY"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select product,locale,keyword,row_number() over(partition by keyword,product  order by keyword,product,locale)PRODUCT_LOCAL_KEY\nfrom (\nSELECT c.product,c.locale,KEYWORD\n  FROM\n  (\n    SELECT KEYWORD,\n    lower(regexp_replace(TAG, '( ){1,}','')) as TAG\n    FROM \"BFSI_CI\".\"UAT\".LKP_KW_TAG_MASTER\n    GROUP BY 1,2\n  ) kt\n  INNER JOIN \n  (\n    SELECT lower(regexp_replace(CATEGORY_TAG, '( ){1,}','')) as TAG, CATEGORY_TAG, LOCALE,\n    case when universe ='Credit Cards - US' THEN 'Credit Cards'\n         when universe ='Credit Cards - UK' THEN 'Credit Cards'\n    ELSE universe end as product\n    FROM \"BFSI_CI\".\"UAT\".\"LKP_BFSI_CATEGORY_HIERARCHY\" \n    WHERE PARENT_CATEGORY_DESC <> 'Brands' --AND CATEGORY_TAG not in (select distinct CATEGORY_TAG from \"BFSI_CI\".\"UAT\".\"LKP_BFSI_CATEGORY_HIERARCHY\" where  PARENT_CATEGORY_DESC = 'Brands' )    \n    /*Removed CATEGORY_TAG  filter to include all categories in hierarch table to ensure few tags under Brand Category might exist as Tag in Category for Business Term.*/\n    GROUP BY 1,2, 3, 4\n  ) c  ON LOWER(kt.TAG) = LOWER(c.TAG) \n  WHERE c.CATEGORY_TAG IS NOT NULL\n  GROUP BY 1,2,3) \n  "}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"425404":{"id":425404,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-1848704949,"x":464,"y":112,"width":32,"height":32,"inputConnectorIDs":[425405],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DIM_KW_PRODUCT_LOCALE_KEY"}}}},"visible":true},"200":{"slot":200,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DIM_KW_PRODUCT_LOCALE_KEY"}}}},"visible":true},"201":{"slot":201,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"UAT"}}}},"visible":true},"202":{"slot":202,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BFSI_CI"}}}},"visible":true},"203":{"slot":203,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BFSI_CI"}}}},"visible":true},"204":{"slot":204,"name":"Target Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"target"}}}},"visible":true},"205":{"slot":205,"name":"Source Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"input"}}}},"visible":true},"206":{"slot":206,"name":"Join Expression","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\"target\".\"KEYWORD\"=\"input\".\"KEYWORD\"\nAND\n\"target\".\"LOCALE\"=\"input\".\"LOCALE\"\nAND\n\"target\".\"PROEDUCT\"=\"input\".\"PRODUCT\""},"2":{"slot":2,"type":"STRING","value":"Join"}}}},"visible":true},"207":{"slot":207,"name":"When Matched","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\"target\".\"KEYWORD\"=\"input\".\"KEYWORD\"\nAND\n\"target\".\"LOCALE\"=\"input\".\"LOCALE\"\nAND\n\"target\".\"PROEDUCT\"=\"input\".\"PRODUCT\""},"2":{"slot":2,"type":"STRING","value":"Update"}}}},"visible":true},"208":{"slot":208,"name":"Update Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PRODUCT"},"2":{"slot":2,"type":"STRING","value":"PROEDUCT"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"LOCALE"},"2":{"slot":2,"type":"STRING","value":"LOCALE"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"KEYWORD"},"2":{"slot":2,"type":"STRING","value":"KEYWORD"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"PRODUCT_LOCAL_KEY"},"2":{"slot":2,"type":"STRING","value":"PRODUCT_LOCAL_KEY"}}}},"visible":true},"209":{"slot":209,"name":"Include Not Matched","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"210":{"slot":210,"name":"Insert Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PRODUCT"},"2":{"slot":2,"type":"STRING","value":"PROEDUCT"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"LOCALE"},"2":{"slot":2,"type":"STRING","value":"LOCALE"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"KEYWORD"},"2":{"slot":2,"type":"STRING","value":"KEYWORD"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"PRODUCT_LOCAL_KEY"},"2":{"slot":2,"type":"STRING","value":"PRODUCT_LOCAL_KEY"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"425405":{"id":425405,"sourceID":425392,"targetID":425404}},"canUndo":true,"undoCommand":"Move Components","undoCreated":1598447272878,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"DIM_KW_PRODUCT_LOCALE_KEY","description":null,"type":"TRANSFORMATION"}}