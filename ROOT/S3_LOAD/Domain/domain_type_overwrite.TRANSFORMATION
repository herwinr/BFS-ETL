{"job":{"components":{"267633":{"id":267633,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":257,"y":101,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[267654],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SQL 0"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select\n    domain,\n    domain_type_one,\n    domain_type_two,\n    case \n        when domain_type_one = 'Others' and domain_type_two <> 'Others' then domain_type_two\n        else domain_type_one\n    end as domain_type_new\nfrom\n(\n  select \n    a.domain,\n    b.domain_type as domain_type_one,\n    c.domain_type as domain_type_two\n  from\n(\n  select \n    domain,\n    count(locale)\n  from \"BFSI_CI\".\"UAT\".\"DIM_BFSI_DOMAIN_TYPE\"\n  group by domain\n  having count(locale) >1\n) as a\nleft join \n(\n  select\n    domain,\n    domain_type\n  from \"BFSI_CI\".\"UAT\".\"DIM_BFSI_DOMAIN_TYPE\" where  locale = 'en-us'\n)as b\non a.domain = b.domain\nleft join \n(\n  select\n    domain,\n    domain_type\n  from \"BFSI_CI\".\"UAT\".\"DIM_BFSI_DOMAIN_TYPE\" where  locale = 'en-gb'\n)as c\non a.domain = c.domain\n\n)\norder by domain"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"267643":{"id":267643,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-1848704949,"x":528,"y":96,"width":32,"height":32,"inputConnectorIDs":[267654],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DIM_BFSI_DOMAIN_TYPE"}}}},"visible":true},"200":{"slot":200,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DIM_BFSI_DOMAIN_TYPE"}}}},"visible":true},"201":{"slot":201,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"UAT"}}}},"visible":true},"202":{"slot":202,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BFSI_CI"}}}},"visible":true},"203":{"slot":203,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BFSI_CI"}}}},"visible":true},"204":{"slot":204,"name":"Target Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"target"}}}},"visible":true},"205":{"slot":205,"name":"Source Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"input"}}}},"visible":true},"206":{"slot":206,"name":"Join Expression","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\"target\".\"DOMAIN\" = \"input\".\"DOMAIN\"\n"},"2":{"slot":2,"type":"STRING","value":"Join"}}}},"visible":true},"207":{"slot":207,"name":"When Matched","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""},"2":{"slot":2,"type":"STRING","value":"Update"}}}},"visible":true},"208":{"slot":208,"name":"Update Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DOMAIN"},"2":{"slot":2,"type":"STRING","value":"DOMAIN"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"DOMAIN_TYPE_NEW"},"2":{"slot":2,"type":"STRING","value":"DOMAIN_TYPE"}}}},"visible":true},"209":{"slot":209,"name":"Include Not Matched","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"210":{"slot":210,"name":"Insert Mapping","elements":{},"visible":false}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"267654":{"id":267654,"sourceID":267633,"targetID":267643}},"canUndo":true,"undoCommand":"Set Parameter","undoCreated":1593783649497,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"domain_type_overwrite","description":"","type":"TRANSFORMATION"}}