{"job":{"components":{"370912":{"id":370912,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":336,"y":96,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[370924],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STG_BFSI_SERP"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STG_BFSI_SERPACK_BKP"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"REFERENCE_DATE"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"KEYWORD"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"LOCALE"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"DEVICE_TYPE"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"BLENDED_RANK"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"PACK_TYPE"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"CREATED_DATE"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"UPDATED_DATE"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"FILENAME"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"UAT"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BFSI_CI"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"370925":{"id":370925,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":211954775,"x":656,"y":96,"width":32,"height":32,"inputConnectorIDs":[370924],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LKP_BFSI_SERP_DAILY"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LKP_BFSI_SERPPACK_DAILY"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"REFERENCE_DATE"},"2":{"slot":2,"type":"STRING","value":"as_on_date"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"KEYWORD"},"2":{"slot":2,"type":"STRING","value":"keyword"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"LOCALE"},"2":{"slot":2,"type":"STRING","value":"locale"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"DEVICE_TYPE"},"2":{"slot":2,"type":"STRING","value":"device_type"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"BLENDED_RANK"},"2":{"slot":2,"type":"STRING","value":"blended_rank"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"PACK_TYPE"},"2":{"slot":2,"type":"STRING","value":"pack_type"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"CREATED_DATE"},"2":{"slot":2,"type":"STRING","value":"created_date"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"UPDATED_DATE"},"2":{"slot":2,"type":"STRING","value":"updated_date"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"FILENAME"},"2":{"slot":2,"type":"STRING","value":"file_name"}}}},"visible":true},"5":{"slot":5,"name":"Truncate","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Append"}}}},"visible":true},"200":{"slot":200,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DWH"}}}},"visible":true},"201":{"slot":201,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BFS_DEV"}}}},"visible":true},"202":{"slot":202,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BFSI_CI"}}}},"visible":true},"203":{"slot":203,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"399913":{"id":399913,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":100,"y":138,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SQL 0"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":" SELECT \n          b.DATE AS AS_OF_DATE,\n          KEYWORD,\n          TRUNC(LOAD_DATE,'MONTH') MONTH_START_DATE,\n          LOAD_DATE AS RANK_DATE,\n          DEVICE,\n          URL,\n          LOCALE,\n          DOMAIN,\n          'google' as SEARCH_ENGINE, \n          ORGANIC_RANK,\n          CASE WHEN b.DATE >=  RANK_DATE THEN CTR ELSE 0  END AS CTR,\n       row_number()\n     over (Partition By AS_OF_DATE,keyword,url,locale,DEVICE  ORDER BY AS_OF_DATE,RANK_DATE desc) as row_number\n    FROM \"BFSI_CI\".\"UAT\".RANK_DATA a,\n    (SELECT DATE,TRUNC(DATE,'MONTH') AS MONTH_START_DATE FROM UAT.DATE_DIM WHERE DATE BETWEEN '2020-04-01' AND '2020-04-16' GROUP BY 1,2) b\n    WHERE LOAD_DATE IS NOT NULL  --AND  TRUNC(LOAD_DATE,'MONTH') = TRUNC(b.DATE ,'MONTH') \n    AND CASE WHEN b.DATE >=  RANK_DATE THEN CTR ELSE 0  END  <> 0\n   --AND keyword IN ('debt relief for bad credit','credit karma discover secured card','amazon check balance credit','apply for a business loan with bad credit','apr meaning credit','bank of america credit monitoring')\n   --AND KEYWORD IN('credit card','credit karma discover secured card') \n order by as_of_date,ORGANIC_RANK"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"370924":{"id":370924,"sourceID":370912,"targetID":370925}},"canUndo":true,"undoCommand":"Set Parameter","undoCreated":1597756269078,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"SERP","description":null,"type":"TRANSFORMATION"}}